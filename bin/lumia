#!/usr/bin/env python3

import sys
from loguru import logger
from lumia import ui


if __name__ == '__main__':

    args = ui.parse_args(sys.argv[1:])

    # Most basic case: just run lumia
    logger.remove()
    logger.add(sys.stderr, level=args.verbosity, backtrace=False, diagnose=True)

    # Read and append configuration file
    rcf = ui.parse_config(args)

    match args.action:
        case 'forward':
            results = ui.forward(rcf)

        case 'optim':
            results = ui.optimize(rcf)

        case 'adjtest':
            results = ui.adjtest(rcf)

        case 'adjtestmod':
            results = ui.adjtestmod(rcf)

        case 'gradtest':
            results = ui.gradtest(rcf)

        case 'emis':
            emis = ui.load_emissions(rcf)

        case 'validate':
            results = ui.validate(rcf)
